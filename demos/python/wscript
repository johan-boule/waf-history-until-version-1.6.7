#! /usr/bin/env python
# encoding: utf-8
# Gustavo Carneiro, 2007

import sys
from Params import fatal

# the following two variables are used by the target "waf dist"
VERSION='0.0.1'
APPNAME='python_test'

# these variables are mandatory ('/' are converted automatically)
srcdir = '.'
blddir = 'build'

def set_options(opt):
	opt.tool_options('python') # options for disabling pyc or pyo compilation
	opt.tool_options('msvc')
	opt.tool_options('gcc')

def configure(conf):
	if not conf.check_tool('msvc'):
		if not conf.check_tool('gcc'):
			fatal("Error: no C compiler was found in PATH.")
	if not (conf.check_tool('python')
			and conf.check_python_version((2,4,2))
			and	conf.check_python_headers()):
		fatal("Error: missing Python development environment.\n"
			  "(Hint: if you do not have a debugging Python library installed"
			  " try using the configure option '--debug-level release')")

def build(bld):
	# first compile a few pyc and pyo files
	obj = bld.create_obj('py')
	#obj.source = 'foo.py'
	obj.find_sources_in_dirs('.')

	# then a c extension module
	obj = bld.create_obj('cc', 'shlib', 'pyext')
	obj.source = 'spammodule.c'
	obj.target = 'spam'

	# then a c program
	obj = bld.create_obj('cc', 'program', 'pyembed')
	obj.source = 'test.c'
	obj.target = 'test'

def shutdown():
	#import os
	#print os.popen('build/default/test').read()
	pass


